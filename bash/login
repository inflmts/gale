#
# ~/.bash_profile
#
# This file is part of Gale.
#

# use vim as editor
export EDITOR=vim

# explicitly specify xdg dirs
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME="$HOME/.data"
export XDG_STATE_HOME="$HOME/.state"
export XDG_CACHE_HOME="$HOME/.cache"

# don't justify man pages
export MANOPT='--nj'

export PATH

# prepend an entry to $PATH
prepend_path() {
  case :"$PATH": in
    *:"$1":*) ;;
    *) PATH="$1:$PATH" ;;
  esac
}

# add standard executable directory
prepend_path ~/.local/bin

unset -f prepend_path

# quit unless interactive
[[ $- != *i* ]] && return

# dialogmenu
#
#   A login menu using dialog(1).
#
dialogmenu() {
  local resp

  while resp="$(dialog --menu Menu 0 0 0 \
    c 'return to command line' \
    q 'logout' \
    s 'sleep' \
    o 'shutdown' \
    r 'reboot' \
    x 'launch X' \
    3>&1 1>&2 2>&3 3>&-
  )"; do  # ^
          # swap stdout and stderr

    case "$resp" in
      q)
        clear
        exit
        ;;
      s)
        systemctl suspend
        ;;
      o)
        clear
        poweroff
        break
        ;;
      r)
        clear
        reboot
        break
        ;;
      x)
        clear
        launchx bspwm
        ;;
      *)
        clear
        break
        ;;
    esac
  done
}

# CTRL-O opens dialogmenu
bind -m emacs -x '"\C-o":dialogmenu'
bind -m vi-command -x '"\C-o":dialogmenu'
bind -m vi-insert -x '"\C-o":dialogmenu'

# load ~/.bashrc
. ~/.bashrc

# vim:ft=bash
