#
# Sway configuration file
#
# This file is part of Gale.
#
# Sway is a tiling Wayland compositor that serves as a replacement for the i3
# window manager. It is based on the wlroots project.
#
# Project website: https://swaywm.org
# Source code: https://github.com/swaywm/sway
#
# Documentation:
#   - sway(5)
#   - sway-input(5)
#   - sway-output(5)
#   - sway-bar(5)
#   - https://github.com/swaywm/sway/wiki
#

# GENERAL
#=======================================

set $mod Mod4

# class                   border    backgr    text      [indic]
client.focused            #ffffff   #ffffff   #101012   #ffffff
client.focused_inactive   #404048   #404048   #ffffff   #404048
client.unfocused          #303036   #303036   #ffffff   #303036

smart_borders on
font Exo 2 10
titlebar_padding 4 4
default_border pixel 1
default_floating_border pixel 1
focus_on_window_activation focus

# BAR
#=======================================

exec gale-sway-waybar start

# INPUTS
#=======================================

input type:keyboard {
  repeat_delay 300
  repeat_rate 25
}

floating_modifier $mod

# OUTPUTS
#=======================================

# generated by gale-sway-outputs
include $XDG_RUNTIME_DIR/gale/sway-outputs.conf

# TODO: this is a temporary hack
output * bg ~/bg/neocity-red.png fill

# KEY BINDINGS
#=======================================

# GENERAL
#-----------------------------

# close any window
bindsym $mod+q kill

# reload the configuration file
bindsym $mod+r reload

# start a terminal
bindsym $mod+Return exec term

# start a file explorer
bindsym $mod+e exec gale-explorer

# CONTAINERS
#-----------------------------

# focus the parent container
bindsym $mod+a focus parent

# focus most recent child container
bindsym $mod+Shift+a focus child

# focus container
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move container
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# WORKSPACES
#-----------------------------

# focus workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1 ; workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2 ; workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3 ; workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4 ; workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5 ; workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6 ; workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7 ; workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8 ; workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9 ; workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10; workspace number 10

# focus previous/next workspace on output
bindsym $mod+comma workspace prev_on_output
bindsym $mod+period workspace next_on_output

# focus empty workspace
bindsym $mod+Tab exec ~/gale/sway/empty-workspace.sh focus
# move focused container to empty workspace
bindsym $mod+Shift+Tab exec ~/gale/sway/empty-workspace.sh move

# OUTPUTS
#-----------------------------

# focus output
bindsym $mod+bracketleft focus output left
bindsym $mod+bracketright focus output right

# move focused workspace to output
bindsym $mod+Shift+bracketleft move workspace to output left
bindsym $mod+Shift+bracketright move workspace to output right

bindsym $mod+o mode "outputs"
mode "outputs" {
  bindsym q mode "default"
  bindsym Escape mode "default"
}

# LAYOUT
#-----------------------------

# change container split
bindsym $mod+b splith
bindsym $mod+v splitv

# switch the current container between different layout styles
bindsym $mod+Shift+s layout stacking
bindsym $mod+Shift+t layout tabbed
bindsym $mod+Shift+b layout splith
bindsym $mod+Shift+v layout splitv

# toggle fullscreen for focused container
bindsym $mod+f fullscreen

# toggle the focused container between tiling/floating
bindsym $mod+Shift+Space floating toggle

# change focus between tiling/floating area
bindsym $mod+Space focus mode_toggle

# VOLUME
#-----------------------------

# volume is changed using pamixer
bindsym XF86AudioLowerVolume exec pamixer -d 5
bindsym XF86AudioRaiseVolume exec pamixer -i 5
bindsym XF86AudioMute exec pamixer -t
bindsym Shift+XF86AudioLowerVolume exec pamixer --set-volume 0
bindsym Shift+XF86AudioRaiseVolume exec pamixer --set-volume 100

# COMMAND MODE
#-----------------------------

bindsym $mod+Shift+c mode "command"

mode "command" {
  bindsym q mode "default"
  bindsym Escape mode "default"

  bindsym e exit
  bindsym s nop wait for suspend
  bindsym o nop wait for poweroff
  bindsym r nop wait for reboot
  bindsym --release s mode "default"; exec systemctl suspend
  bindsym --release o mode "default"; exec systemctl poweroff
  bindsym --release r mode "default"; exec systemctl reboot
}

# RESIZE MODE
#-----------------------------

bindsym $mod+z mode "resize"

mode "resize" {
  bindsym q mode "default"
  bindsym Escape mode "default"

  # grow using direction keys
  bindsym h resize grow left 10px
  bindsym j resize grow down 10px
  bindsym k resize grow up 10px
  bindsym l resize grow right 10px

  # shrink using shift + direction keys
  bindsym Shift+h resize shrink right 10px
  bindsym Shift+j resize shrink up 10px
  bindsym Shift+k resize shrink down 10px
  bindsym Shift+l resize shrink left 10px
}

# MISC MODE
#-----------------------------

bindsym $mod+x mode "misc"

mode "misc" {
  bindsym q mode "default"
  bindsym Escape mode "default"

  bindsym f exec firefox; mode "default"
  bindsym m exec multimc; mode "default"
  bindsym t exec term htop; mode "default"
  bindsym Shift+r exec term radeontop; mode "default"
}

# INITIALIZATION
#=======================================

# export environment to systemd
exec systemctl --user import-environment WAYLAND_DISPLAY DISPLAY >/dev/null 2>&1

# start autosleep
exec gale-autosleep start
